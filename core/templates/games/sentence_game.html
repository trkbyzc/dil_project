<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Sentence Master - Grammar Challenge</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
:root {--primary-color: #6366f1;--primary-dark: #4f46e5;--primary-light: #818cf8;--secondary-color: #f59e0b;--success-color: #10b981;--error-color: #ef4444;--text-primary: #1f2937;--text-secondary: #6b7280;--text-light: #9ca3af;--bg-primary: #ffffff;--bg-secondary: #f9fafb;--bg-tertiary: #f3f4f6;--border-color: #e5e7eb;--shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);--shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);--shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);--radius-sm: 0.375rem;--radius-lg: 0.75rem;--radius-xl: 1rem;--radius-2xl: 1.5rem;}
* {margin: 0;padding: 0;box-sizing: border-box;}
body {font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);min-height: 100vh;color: var(--text-primary);overflow-x: hidden;position: relative;}
.background-animation {position: fixed;top: 0;left: 0;width: 100%;height: 100%;z-index: -2;background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);}
.floating-shapes {position: absolute;width: 100%;height: 100%;overflow: hidden;}
.shape {position: absolute;background: rgba(255, 255, 255, 0.1);border-radius: 50%;animation: float 20s infinite linear;}
.shape-1 {width: 80px;height: 80px;left: 10%;animation-delay: 0s;}
.shape-2 {width: 120px;height: 120px;left: 20%;animation-delay: 2s;}
.shape-3 {width: 60px;height: 60px;left: 70%;animation-delay: 4s;}
.shape-4 {width: 100px;height: 100px;left: 80%;animation-delay: 6s;}
.shape-5 {width: 140px;height: 140px;left: 50%;animation-delay: 8s;}
@keyframes float {0% {transform: translateY(100vh) rotate(0deg);opacity: 0;}10% {opacity: 1;}90% {opacity: 1;}100% {transform: translateY(-100px) rotate(360deg);opacity: 0;}}
.floating-particles {position: fixed;top: 0;left: 0;width: 100%;height: 100%;pointer-events: none;z-index: -1;}
.particle {position: absolute;width: 4px;height: 4px;background: rgba(255, 255, 255, 0.6);border-radius: 50%;animation: particle-float 15s infinite linear;}
.particle:nth-child(1) {left: 20%;animation-delay: 0s;}
.particle:nth-child(2) {left: 40%;animation-delay: 3s;}
.particle:nth-child(3) {left: 60%;animation-delay: 6s;}
.particle:nth-child(4) {left: 80%;animation-delay: 9s;}
.particle:nth-child(5) {left: 90%;animation-delay: 12s;}
@keyframes particle-float {0% {transform: translateY(100vh);opacity: 0;}10% {opacity: 1;}90% {opacity: 1;}100% {transform: translateY(-10px);opacity: 0;}}
.container {max-width: 1200px;margin: 0 auto;padding: 2rem 1rem;position: relative;z-index: 1;}
.main-header {text-align: center;margin-bottom: 3rem;animation: slideInDown 0.8s ease-out;}
.logo-container {display: flex;align-items: center;justify-content: center;gap: 1rem;margin-bottom: 1rem;}
.logo-icon {width: 80px;height: 80px;background: rgba(255, 255, 255, 0.2);border-radius: var(--radius-2xl);display: flex;align-items: center;justify-content: center;backdrop-filter: blur(10px);border: 1px solid rgba(255, 255, 255, 0.3);}
.logo-icon .material-icons {font-size: 2.5rem;color: white;}
.title-group h1 {font-family: "Poppins", sans-serif;font-size: 3.5rem;font-weight: 800;color: white;text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);margin: 0;letter-spacing: -0.02em;}
.title-group p {font-size: 1.25rem;color: rgba(255, 255, 255, 0.9);font-weight: 500;margin: 0.5rem 0 0 0;}
.modern-card {background: rgba(255, 255, 255, 0.95);backdrop-filter: blur(20px);border-radius: var(--radius-2xl);border: 1px solid rgba(255, 255, 255, 0.2);box-shadow: var(--shadow-xl);padding: 2rem;margin-bottom: 2rem;animation: slideInUp 0.8s ease-out;}
.level-select {max-width: 600px;margin: 0 auto 2rem auto;}
.card-header {text-align: center;margin-bottom: 2rem;}
.card-header h2 {font-family: "Poppins", sans-serif;font-size: 2rem;font-weight: 700;color: var(--text-primary);margin-bottom: 0.5rem;}
.card-header p {color: var(--text-secondary);font-size: 1.1rem;}
.level-options {display: flex;flex-direction: column;gap: 1rem;margin-bottom: 2rem;}
.level-option input[type="radio"] {display: none;}
.level-option label {display: flex;align-items: center;gap: 1rem;padding: 1.5rem;border: 2px solid var(--border-color);border-radius: var(--radius-xl);cursor: pointer;transition: all 0.3s ease;background: var(--bg-primary);}
.level-option label:hover {border-color: var(--primary-light);transform: translateY(-2px);box-shadow: var(--shadow-lg);}
.level-option input[type="radio"]:checked + label {border-color: var(--primary-color);background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);color: white;transform: translateY(-2px);box-shadow: var(--shadow-lg);}
.level-icon {width: 60px;height: 60px;border-radius: var(--radius-lg);display: flex;align-items: center;justify-content: center;background: var(--bg-secondary);transition: all 0.3s ease;}
.level-option input[type="radio"]:checked + label .level-icon {background: rgba(255, 255, 255, 0.2);}
.level-icon .material-icons {font-size: 1.8rem;color: var(--primary-color);}
.level-option input[type="radio"]:checked + label .level-icon .material-icons {color: white;}
.level-info {flex: 1;}
.level-info h3 {font-family: "Poppins", sans-serif;font-size: 1.25rem;font-weight: 600;margin-bottom: 0.25rem;}
.level-info span {color: var(--text-secondary);font-size: 0.9rem;font-weight: 500;}
.level-option input[type="radio"]:checked + label .level-info span {color: rgba(255, 255, 255, 0.8);}
.level-description {font-size: 0.85rem;color: var(--text-light);margin-top: 0.25rem;}
.level-option input[type="radio"]:checked + label .level-description {color: rgba(255, 255, 255, 0.7);}
.level-stats {display: flex;flex-direction: column;gap: 0.5rem;}
.stat {display: flex;align-items: center;gap: 0.5rem;font-size: 0.9rem;color: var(--text-secondary);}
.level-option input[type="radio"]:checked + label .stat {color: rgba(255, 255, 255, 0.8);}
.stat .material-icons {font-size: 1.2rem;}
.start-button {width: 100%;padding: 1rem 2rem;background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);color: white;border: none;border-radius: var(--radius-xl);font-size: 1.1rem;font-weight: 600;cursor: pointer;transition: all 0.3s ease;display: flex;align-items: center;justify-content: center;gap: 0.5rem;box-shadow: var(--shadow-md);}
.start-button:hover {transform: translateY(-2px);box-shadow: var(--shadow-lg);background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-color) 100%);}
.game-section {display: none;max-width: 800px;margin: 0 auto;}
.game-header {display: flex;justify-content: space-between;align-items: center;margin-bottom: 2rem;flex-wrap: wrap;gap: 1rem;}
.progress-container {flex: 1;min-width: 200px;}
.progress-bar {width: 100%;height: 8px;background: var(--bg-tertiary);border-radius: var(--radius-sm);overflow: hidden;margin-bottom: 0.5rem;}
.progress-fill {height: 100%;background: linear-gradient(90deg, var(--primary-color) 0%, var(--primary-light) 100%);border-radius: var(--radius-sm);transition: width 0.3s ease;width: 10%;}
.progress-text {font-size: 0.9rem;color: var(--text-secondary);font-weight: 500;}
.game-stats {display: flex;gap: 1rem;}
.stat-item {display: flex;align-items: center;gap: 0.75rem;padding: 0.75rem 1rem;background: var(--bg-secondary);border-radius: var(--radius-lg);border: 1px solid var(--border-color);}
.stat-item .material-icons {font-size: 1.5rem;color: var(--primary-color);}
.stat-info {display: flex;flex-direction: column;}
.stat-value {font-size: 1.25rem;font-weight: 700;color: var(--text-primary);}
.stat-label {font-size: 0.75rem;color: var(--text-secondary);text-transform: uppercase;letter-spacing: 0.05em;}
.question-display-container {text-align: center;margin-bottom: 2rem;}
.question-card {background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);border: 2px solid var(--border-color);border-radius: var(--radius-2xl);padding: 2rem;margin-bottom: 1rem;transition: all 0.3s ease;}
.question-label {font-size: 1rem;color: var(--text-secondary);margin-bottom: 1rem;font-weight: 500;}
.question-text {font-family: "Poppins", sans-serif;font-size: 1.5rem;font-weight: 600;color: var(--text-primary);line-height: 1.4;letter-spacing: -0.01em;}
.choices-container {display: grid;grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));gap: 1rem;margin-bottom: 2rem;}
.choice-btn {padding: 1.25rem 1.5rem;background: var(--bg-primary);border: 2px solid var(--border-color);border-radius: var(--radius-xl);font-size: 1.1rem;font-weight: 500;color: var(--text-primary);cursor: pointer;transition: all 0.3s ease;text-align: left;position: relative;overflow: hidden;}
.choice-btn:hover {border-color: var(--primary-color);transform: translateY(-2px);box-shadow: var(--shadow-md);}
.choice-btn:disabled {cursor: not-allowed;opacity: 0.7;}
.feedback-message {text-align: center;min-height: 2rem;font-size: 1.1rem;font-weight: 600;display: flex;align-items: center;justify-content: center;gap: 0.5rem;}
.feedback-message.correct {color: var(--success-color);}
.feedback-message.wrong {color: var(--error-color);}
.game-over {display: none;max-width: 600px;margin: 0 auto;text-align: center;}
.result-header {margin-bottom: 2rem;}
.result-icon {width: 100px;height: 100px;margin: 0 auto 1rem auto;background: linear-gradient(135deg, var(--secondary-color) 0%, #f59e0b 100%);border-radius: 50%;display: flex;align-items: center;justify-content: center;animation: bounce 1s ease-out;}
.result-icon .material-icons {font-size: 3rem;color: white;}
.result-header h2 {font-family: "Poppins", sans-serif;font-size: 2rem;font-weight: 700;color: var(--text-primary);margin-bottom: 1rem;}
.final-score {font-size: 1.25rem;color: var(--text-secondary);line-height: 1.6;}
.performance-chart {display: flex;gap: 2rem;margin-bottom: 2rem;justify-content: center;}
.chart-item {flex: 1;max-width: 150px;}
.chart-bar {height: 120px;width: 40px;background: var(--bg-tertiary);border-radius: var(--radius-lg);margin: 0 auto 1rem auto;position: relative;overflow: hidden;}
.chart-fill {position: absolute;bottom: 0;width: 100%;border-radius: var(--radius-lg);transition: height 1s ease-out;height: 0%;}
.chart-item.correct .chart-fill {background: linear-gradient(180deg, var(--success-color) 0%, #059669 100%);}
.chart-item.wrong .chart-fill {background: linear-gradient(180deg, var(--error-color) 0%, #dc2626 100%);}
.chart-label {display: flex;flex-direction: column;align-items: center;gap: 0.25rem;font-size: 0.9rem;color: var(--text-secondary);}
.chart-label .material-icons {font-size: 1.5rem;}
.chart-item.correct .chart-label .material-icons {color: var(--success-color);}
.chart-item.wrong .chart-label .material-icons {color: var(--error-color);}
.wrong-summary {background: var(--bg-secondary);border-radius: var(--radius-xl);padding: 1.5rem;margin-bottom: 2rem;text-align: left;max-height: 300px;overflow-y: auto;}
.action-buttons {display: flex;gap: 1rem;justify-content: center;}
.primary-button, .secondary-button {padding: 0.75rem 1.5rem;border-radius: var(--radius-lg);font-size: 1rem;font-weight: 600;cursor: pointer;transition: all 0.3s ease;display: flex;align-items: center;gap: 0.5rem;border: none;}
.primary-button {background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);color: white;box-shadow: var(--shadow-md);}
.primary-button:hover {transform: translateY(-2px);box-shadow: var(--shadow-lg);}
.secondary-button {background: var(--bg-primary);color: var(--text-primary);border: 2px solid var(--border-color);}
.secondary-button:hover {border-color: var(--primary-color);transform: translateY(-2px);box-shadow: var(--shadow-md);}
@keyframes slideInDown {from {opacity: 0;transform: translateY(-30px);}to {opacity: 1;transform: translateY(0);}}
@keyframes slideInUp {from {opacity: 0;transform: translateY(30px);}to {opacity: 1;transform: translateY(0);}}
@keyframes bounce {0%, 20%, 53%, 80%, 100% {transform: translate3d(0, 0, 0);}40%, 43% {transform: translate3d(0, -30px, 0);}70% {transform: translate3d(0, -15px, 0);}90% {transform: translate3d(0, -4px, 0);}}
@media (max-width: 768px) {.container {padding: 1rem;}.title-group h1 {font-size: 2.5rem;}.modern-card {padding: 1.5rem;}.game-header {flex-direction: column;align-items: stretch;}.question-text {font-size: 1.25rem;}.choices-container {grid-template-columns: 1fr;}.action-buttons {flex-direction: column;}}
    </style>
</head>
<body>
    <div class="background-animation">
        <div class="floating-shapes">
            <div class="shape shape-1"></div>
            <div class="shape shape-2"></div>
            <div class="shape shape-3"></div>
            <div class="shape shape-4"></div>
            <div class="shape shape-5"></div>
        </div>
    </div>
    
    <div class="container">
        <header class="main-header">
            <div class="logo-container">
                <div class="logo-icon">
                    <span class="material-icons">auto_stories</span>
                </div>
                <div class="title-group">
                    <h1>Sentence Master</h1>
                    <p>Perfect Your Grammar Skills</p>
                </div>
            </div>
        </header>

        <div class="level-select modern-card" id="levelSelect">
            <div class="card-header">
                <h2>Choose Your Challenge</h2>
                <p>Select your grammar level to begin</p>
            </div>
            
            <div class="level-options">
                <div class="level-option" data-level="A2">
                    <input type="radio" id="level-beginner" name="level" value="A2" checked>
                    <label for="level-beginner">
                        <div class="level-icon">
                            <span class="material-icons">school</span>
                        </div>
                        <div class="level-info">
                            <h3>Beginner</h3>
                            <span>A2 Level</span>
                            <div class="level-description">Basic sentence structure</div>
                        </div>
                        <div class="level-stats">
                            <div class="stat">
                                <span class="material-icons">quiz</span>
                                <span>10 Questions</span>
                            </div>
                        </div>
                    </label>
                </div>

                <div class="level-option" data-level="B1">
                    <input type="radio" id="level-intermediate" name="level" value="B1">
                    <label for="level-intermediate">
                        <div class="level-icon">
                            <span class="material-icons">trending_up</span>
                        </div>
                        <div class="level-info">
                            <h3>Intermediate</h3>
                            <span>B1 Level</span>
                            <div class="level-description">Complex grammar rules</div>
                        </div>
                        <div class="level-stats">
                            <div class="stat">
                                <span class="material-icons">quiz</span>
                                <span>10 Questions</span>
                            </div>
                        </div>
                    </label>
                </div>

                <div class="level-option" data-level="B2-C1">
                    <input type="radio" id="level-advanced" name="level" value="B2-C1">
                    <label for="level-advanced">
                        <div class="level-icon">
                            <span class="material-icons">military_tech</span>
                        </div>
                        <div class="level-info">
                            <h3>Advanced</h3>
                            <span>B2-C1 Level</span>
                            <div class="level-description">Professional grammar</div>
                        </div>
                        <div class="level-stats">
                            <div class="stat">
                                <span class="material-icons">quiz</span>
                                <span>10 Questions</span>
                            </div>
                        </div>
                    </label>
                </div>
            </div>

            <button class="start-button" id="startGame">
                <span class="material-icons">play_arrow</span>
                Start Challenge
            </button>
        </div>

        <section class="game-section modern-card" id="gameSection">
            <div class="game-header">
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text">
                        <span id="questionNum">1</span> / <span id="totalQuestions">10</span>
                    </div>
                </div>
                
                <div class="game-stats">
                    <div class="stat-item score-stat">
                        <span class="material-icons">stars</span>
                        <div class="stat-info">
                            <span class="stat-value" id="score">0</span>
                            <span class="stat-label">Score</span>
                        </div>
                    </div>
                    
                    <div class="stat-item timer-stat">
                        <span class="material-icons">schedule</span>
                        <div class="stat-info">
                            <span class="stat-value" id="time">0</span>
                            <span class="stat-label">Time</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="question-display-container">
                <div class="question-card">
                    <div class="question-label" id="questionLabel">Complete the sentence:</div>
                    <div class="question-text" id="questionText"></div>
                </div>
            </div>

            <div class="choices-container" id="choices"></div>
            
            <div class="feedback-message" id="feedback"></div>
        </section>

        <div class="game-over modern-card" id="gameOver">
            <div class="result-header">
                <div class="result-icon" id="resultIcon">
                    <span class="material-icons">emoji_events</span>
                </div>
                <h2 id="resultTitle">Challenge Complete!</h2>
                <div class="final-score" id="finalScore"></div>
            </div>

            <div class="performance-chart">
                <div class="chart-item correct">
                    <div class="chart-bar">
                        <div class="chart-fill" id="correctBar"></div>
                    </div>
                    <div class="chart-label">
                        <span class="material-icons">check_circle</span>
                        <span>Correct</span>
                        <span id="correctCount">0</span>
                    </div>
                </div>
                
                <div class="chart-item wrong">
                    <div class="chart-bar">
                        <div class="chart-fill" id="wrongBar"></div>
                    </div>
                    <div class="chart-label">
                        <span class="material-icons">cancel</span>
                        <span>Wrong</span>
                        <span id="wrongCount">0</span>
                    </div>
                </div>
            </div>

            <div class="wrong-summary" id="wrongSummary"></div>

            <div class="action-buttons">
                <button class="secondary-button" onclick="window.location.href='/'">
                    <span class="material-icons">home</span>
                    Home
                </button>
                <button class="primary-button" id="playAgain">
                    <span class="material-icons">refresh</span>
                    Play Again
                </button>
            </div>
        </div>
    </div>

    <div class="floating-particles">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
    </div>

    <script>
// Sentence Game - CÃ¼mle UstasÄ± Oyunu
document.addEventListener("DOMContentLoaded", () => {
  // Soru havuzlarÄ±
  const questionPools = {
    "A2": [
      { type: "fill", q: "I ___ a student.", a: "am", choices: ["is", "am", "are", "be"] },
      { type: "fill", q: "She ___ to school every day.", a: "goes", choices: ["go", "goes", "going", "gone"] },
      { type: "fill", q: "They ___ happy.", a: "are", choices: ["is", "am", "are", "be"] },
      { type: "fill", q: "He ___ a book.", a: "reads", choices: ["read", "reads", "reading", "readed"] },
      { type: "fill", q: "We ___ at home.", a: "are", choices: ["is", "am", "are", "be"] },
      { type: "fill", q: "It ___ cold today.", a: "is", choices: ["is", "are", "am", "be"] },
      { type: "fill", q: "My father ___ a doctor.", a: "is", choices: ["is", "are", "am", "be"] },
      { type: "fill", q: "The children ___ playing.", a: "are", choices: ["is", "are", "was", "were"] },
      { type: "fill", q: "I ___ coffee every morning.", a: "drink", choices: ["drink", "drinks", "drinking", "drank"] },
      { type: "fill", q: "She ___ English well.", a: "speaks", choices: ["speak", "speaks", "speaking", "spoke"] }
    ],
    "B1": [
      { type: "fill", q: "I ___ to the gym on Mondays.", a: "go", choices: ["go", "goes", "going", "gone"] },
      { type: "fill", q: "We ___ English for two years.", a: "have studied", choices: ["studied", "have studied", "studying", "study"] },
      { type: "fill", q: "She ___ coffee.", a: "doesn't like", choices: ["don't like", "doesn't like", "not like", "isn't like"] },
      { type: "fill", q: "They ___ never visited Istanbul.", a: "have", choices: ["has", "have", "had", "having"] },
      { type: "fill", q: "I ___ call you later.", a: "will", choices: ["will", "would", "shall", "should"] },
      { type: "fill", q: "The movie ___ very interesting.", a: "was", choices: ["is", "was", "were", "are"] },
      { type: "fill", q: "He ___ working here since 2020.", a: "has been", choices: ["is", "was", "has been", "have been"] },
      { type: "fill", q: "We ___ to the party yesterday.", a: "went", choices: ["go", "went", "gone", "going"] },
      { type: "fill", q: "She ___ finish her homework.", a: "must", choices: ["must", "can", "may", "might"] },
      { type: "fill", q: "I ___ seen this movie before.", a: "have", choices: ["has", "have", "had", "having"] }
    ],
    "B2-C1": [
      { type: "fill", q: "If I ___ more time, I would travel.", a: "had", choices: ["have", "had", "has", "having"] },
      { type: "fill", q: "She ___ three books so far.", a: "has written", choices: ["wrote", "has written", "writes", "writing"] },
      { type: "fill", q: "The results ___ announced tomorrow.", a: "will be", choices: ["will", "will be", "are", "is"] },
      { type: "fill", q: "He ___ to have finished the project.", a: "claims", choices: ["claim", "claims", "claimed", "claiming"] },
      { type: "fill", q: "They ___ the film yet.", a: "haven't seen", choices: ["didn't see", "haven't seen", "not see", "don't see"] },
      { type: "fill", q: "The book ___ by millions of people.", a: "has been read", choices: ["read", "was read", "has been read", "is reading"] },
      { type: "fill", q: "I wish I ___ speak French fluently.", a: "could", choices: ["can", "could", "would", "should"] },
      { type: "fill", q: "By next year, we ___ living here for 10 years.", a: "will have been", choices: ["will be", "will have been", "are", "have been"] },
      { type: "fill", q: "The meeting ___ postponed due to bad weather.", a: "was", choices: ["is", "was", "has been", "will be"] },
      { type: "fill", q: "She suggested that he ___ a doctor.", a: "see", choices: ["sees", "see", "saw", "seeing"] }
    ]
  }

  // Oyun durumu
  let gameState = {
    level: null,
    questions: [],
    currentIndex: 0,
    score: 0,
    correctAnswers: 0,
    wrongAnswers: 0,
    totalQuestions: 10,
    timeLeft: 0,
    maxTime: 0,
    timer: null,
    canAnswer: true,
    userAnswers: []
  }

  // DOM elementleri
  const levelSelect = document.getElementById("levelSelect")
  const gameSection = document.getElementById("gameSection")
  const gameOver = document.getElementById("gameOver")
  const startGameBtn = document.getElementById("startGame")
  const playAgainBtn = document.getElementById("playAgain")
  
  const questionText = document.getElementById("questionText")
  const choicesDiv = document.getElementById("choices")
  const feedback = document.getElementById("feedback")
  
  const questionNumSpan = document.getElementById("questionNum")
  const scoreSpan = document.getElementById("score")
  const timeSpan = document.getElementById("time")
  const progressFill = document.getElementById("progressFill")
  
  const finalScore = document.getElementById("finalScore")
  const correctBar = document.getElementById("correctBar")
  const wrongBar = document.getElementById("wrongBar")
  const correctCount = document.getElementById("correctCount")
  const wrongCount = document.getElementById("wrongCount")
  const wrongSummary = document.getElementById("wrongSummary")

  // YardÄ±mcÄ± fonksiyonlar
  function shuffle(array) {
    const newArray = [...array]
    for (let i = newArray.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [newArray[i], newArray[j]] = [newArray[j], newArray[i]]
    }
    return newArray
  }

  function getTimeForLevel(level) {
    switch(level) {
      case "A2": return 10
      case "B1": return 8
      case "B2-C1": return 6
      default: return 8
    }
  }

  function updateUI() {
    if (questionNumSpan) questionNumSpan.textContent = gameState.currentIndex + 1
    if (scoreSpan) scoreSpan.textContent = gameState.score
    if (timeSpan) timeSpan.textContent = gameState.timeLeft
    
    // Progress bar gÃ¼ncelle
    const progress = ((gameState.currentIndex + 1) / gameState.totalQuestions) * 100
    if (progressFill) progressFill.style.width = `${progress}%`
  }

  // Oyun fonksiyonlarÄ±
  function startGame() {
    const selectedLevel = document.querySelector('input[name="level"]:checked')?.value
    if (!selectedLevel) return

    // Oyun durumunu sÄ±fÄ±rla
    gameState = {
      level: selectedLevel,
      questions: shuffle(questionPools[selectedLevel] || questionPools["A2"]).slice(0, 10),
      currentIndex: 0,
      score: 0,
      correctAnswers: 0,
      wrongAnswers: 0,
      totalQuestions: 10,
      timeLeft: 0,
      maxTime: getTimeForLevel(selectedLevel),
      timer: null,
      canAnswer: true,
      userAnswers: []
    }

    // EkranlarÄ± deÄŸiÅŸtir
    if (levelSelect) levelSelect.style.display = "none"
    if (gameSection) gameSection.style.display = "block"
    if (gameOver) gameOver.style.display = "none"

    // Ä°lk soruyu baÅŸlat
    nextQuestion()
  }

  function nextQuestion() {
    if (gameState.currentIndex >= gameState.totalQuestions) {
      endGame()
      return
    }

    gameState.canAnswer = true
    const currentQuestion = gameState.questions[gameState.currentIndex]

    // Soruyu gÃ¶ster
    if (questionText) {
      questionText.innerHTML = currentQuestion.q
    }

    // SeÃ§enekleri oluÅŸtur
    if (choicesDiv) {
      choicesDiv.innerHTML = ""
      currentQuestion.choices.forEach(choice => {
        const button = document.createElement("button")
        button.className = "choice-btn"
        button.textContent = choice
        button.onclick = () => selectChoice(choice, currentQuestion.a)
        choicesDiv.appendChild(button)
      })
    }

    // Feedback'i temizle
    if (feedback) {
      feedback.textContent = ""
      feedback.style.color = ""
    }

    // Timer'Ä± baÅŸlat
    gameState.timeLeft = gameState.maxTime
    updateUI()
    startTimer()
  }

  function startTimer() {
    clearInterval(gameState.timer)
    gameState.timer = setInterval(() => {
      gameState.timeLeft--
      updateUI()

      if (gameState.timeLeft <= 0) {
        clearInterval(gameState.timer)
        if (gameState.canAnswer) {
          handleTimeout()
        }
      }
    }, 1000)
  }

  function selectChoice(selectedChoice, correctAnswer) {
    if (!gameState.canAnswer) return

    gameState.canAnswer = false
    clearInterval(gameState.timer)

    const isCorrect = selectedChoice === correctAnswer

    // TÃ¼m butonlarÄ± devre dÄ±ÅŸÄ± bÄ±rak ve renklendir
    const buttons = choicesDiv.querySelectorAll(".choice-btn")
    buttons.forEach(btn => {
      btn.disabled = true
      if (btn.textContent === correctAnswer) {
        btn.style.backgroundColor = "#4CAF50"
        btn.style.color = "white"
      } else if (btn.textContent === selectedChoice && !isCorrect) {
        btn.style.backgroundColor = "#f44336"
        btn.style.color = "white"
      }
    })

    if (isCorrect) {
      gameState.score += 10
      gameState.correctAnswers++
      if (feedback) {
        feedback.textContent = "Correct! ðŸŽ‰"
        feedback.style.color = "#4CAF50"
      }
    } else {
      gameState.wrongAnswers++
      if (feedback) {
        feedback.textContent = `Wrong! Correct answer: ${correctAnswer}`
        feedback.style.color = "#f44336"
      }
    }

    // CevabÄ± kaydet
    gameState.userAnswers.push({
      question: gameState.questions[gameState.currentIndex],
      userAnswer: selectedChoice,
      isCorrect: isCorrect
    })

    updateUI()

    // Sonraki soruya geÃ§
    setTimeout(() => {
      gameState.currentIndex++
      nextQuestion()
    }, 1500)
  }

  function handleTimeout() {
    gameState.canAnswer = false
    gameState.wrongAnswers++

    const currentQuestion = gameState.questions[gameState.currentIndex]

    // DoÄŸru cevabÄ± gÃ¶ster
    const buttons = choicesDiv.querySelectorAll(".choice-btn")
    buttons.forEach(btn => {
      btn.disabled = true
      if (btn.textContent === currentQuestion.a) {
        btn.style.backgroundColor = "#4CAF50"
        btn.style.color = "white"
      }
    })

    if (feedback) {
      feedback.textContent = `Time's up! Correct answer: ${currentQuestion.a}`
      feedback.style.color = "#f44336"
    }

    // CevabÄ± kaydet
    gameState.userAnswers.push({
      question: currentQuestion,
      userAnswer: null,
      isCorrect: false,
      isTimeout: true
    })

    setTimeout(() => {
      gameState.currentIndex++
      nextQuestion()
    }, 1500)
  }

  function endGame() {
    clearInterval(gameState.timer)

    // EkranlarÄ± deÄŸiÅŸtir
    if (gameSection) gameSection.style.display = "none"
    if (gameOver) gameOver.style.display = "block"

    // SonuÃ§larÄ± hesapla
    const accuracy = Math.round((gameState.correctAnswers / gameState.totalQuestions) * 100)

    // Final skorunu gÃ¶ster
    if (finalScore) {
      finalScore.innerHTML = `
        Correct: <b>${gameState.correctAnswers}</b> / Wrong: <b>${gameState.wrongAnswers}</b><br>
        Score: <b>${gameState.score}</b><br>
        Accuracy: <b>${accuracy}%</b>
      `
    }

    // Grafikleri gÃ¼ncelle
    if (correctCount) correctCount.textContent = gameState.correctAnswers
    if (wrongCount) wrongCount.textContent = gameState.wrongAnswers

    setTimeout(() => {
      const correctPercentage = (gameState.correctAnswers / gameState.totalQuestions) * 100
      const wrongPercentage = (gameState.wrongAnswers / gameState.totalQuestions) * 100
      
      if (correctBar) correctBar.style.height = `${correctPercentage}%`
      if (wrongBar) wrongBar.style.height = `${wrongPercentage}%`
    }, 500)

    // Hata Ã¶zetini gÃ¶ster
    showSummary()
  }

  function showSummary() {
    if (!wrongSummary) return

    const mistakes = gameState.userAnswers.filter(answer => !answer.isCorrect)

    if (mistakes.length === 0) {
      wrongSummary.innerHTML = "<h3>ðŸŽ‰ Congratulations! All questions correct!</h3>"
      return
    }

    let html = "<h3>Review Your Mistakes</h3><ul>"
    mistakes.forEach((mistake, index) => {
      const questionText = mistake.question.q
      const userAnswer = mistake.userAnswer || "No answer"
      const correctAnswer = mistake.question.a

      html += `
        <li style="margin-bottom: 1rem; padding: 1rem; border-left: 3px solid #f44336; background: #fafafa;">
          <div><strong>Question ${index + 1}:</strong> ${questionText}</div>
          <div><span style="color: #f44336;">Your answer:</span> ${userAnswer}</div>
          <div><span style="color: #4CAF50;">Correct answer:</span> ${correctAnswer}</div>
        </li>
      `
    })
    html += "</ul>"

    wrongSummary.innerHTML = html
  }

  function resetGame() {
    clearInterval(gameState.timer)
    
    // EkranlarÄ± sÄ±fÄ±rla
    if (levelSelect) levelSelect.style.display = "block"
    if (gameSection) gameSection.style.display = "none"
    if (gameOver) gameOver.style.display = "none"

    // Progress bar'Ä± sÄ±fÄ±rla
    if (progressFill) progressFill.style.width = "0%"
    if (correctBar) correctBar.style.height = "0%"
    if (wrongBar) wrongBar.style.height = "0%"
  }

  // Event listener'lar
  if (startGameBtn) {
    startGameBtn.addEventListener("click", startGame)
  }

  if (playAgainBtn) {
    playAgainBtn.addEventListener("click", resetGame)
  }

  // BaÅŸlangÄ±Ã§ durumu
  resetGame()
})
    </script>
</body>
</html>